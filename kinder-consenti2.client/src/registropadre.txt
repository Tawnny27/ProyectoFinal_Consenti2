import React, { useState } from 'react';
import axios from 'axios';

const RegistrarPadre = () => {
  const [padre, setPadre] = useState({
    idPadre: 0,
    rolId: 0,
    nombrePadre: '',
    apellidosPadre: '',
    cedulaPadre: '',
    telefonoPadre: '',
    correoPadre: '',
    rol: '',
    hijos: [
      {
        idAlumno: 0,
        padreId: 0,
        nombreAlumno: '',
        apellidosAlumno: '',
        fechaNacimiento: '',
        cedulaAlumno: '',
        generoAlumno: '',
        direccionAlumno: '',
        informacionAdicional: '',
        fotoAlumno: '',
        nombreCompAutorizado: '',
        cedulaAutorizado: '',
        telefonoAutorizado: '',
        relacionAutorizado: '',
        nombreCompContacto: '',
        cedulaContacto: '',
        telefonoContacto: '',
        relacionContacto: '',
      },
    ],
  });

  const handleChange = (e) => {
    const { name, value } = e.target;
    setPadre({ ...padre, [name]: value });
  };

  const handleHijoChange = (index, e) => {
    const { name, value } = e.target;
    const updatedHijos = padre.hijos.map((hijo, i) =>
      i === index ? { ...hijo, [name]: value } : hijo
    );
    setPadre({ ...padre, hijos: updatedHijos });
  };

  const agregarHijo = () => {
    setPadre({
      ...padre,
      hijos: [
        ...padre.hijos,
        {
          idAlumno: 0,
          padreId: 0,
          nombreAlumno: '',
          apellidosAlumno: '',
          fechaNacimiento: '',
          cedulaAlumno: '',
          generoAlumno: '',
          direccionAlumno: '',
          informacionAdicional: '',
          fotoAlumno: '',
          nombreCompAutorizado: '',
          cedulaAutorizado: '',
          telefonoAutorizado: '',
          relacionAutorizado: '',
          nombreCompContacto: '',
          cedulaContacto: '',
          telefonoContacto: '',
          relacionContacto: '',
        },
      ],
    });
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    axios
      .post('URL_DEL_BACKEND', padre)
      .then((response) => {
        console.log('Padre registrado:', response.data);
      })
      .catch((error) => {
        console.error('Error registrando padre:', error);
      });
  };

  return (
    <form onSubmit={handleSubmit}>
      <h2>Registrar Padre</h2>
      <input
        type="text"
        name="nombrePadre"
        value={padre.nombrePadre}
        onChange={handleChange}
        placeholder="Nombre del padre"
        required
      />
      <input
        type="text"
        name="apellidosPadre"
        value={padre.apellidosPadre}
        onChange={handleChange}
        placeholder="Apellidos del padre"
        required
      />
      <input
        type="text"
        name="cedulaPadre"
        value={padre.cedulaPadre}
        onChange={handleChange}
        placeholder="Cédula del padre"
        required
      />
      <input
        type="tel"
        name="telefonoPadre"
        value={padre.telefonoPadre}
        onChange={handleChange}
        placeholder="Teléfono del padre"
        required
      />
      <input
        type="email"
        name="correoPadre"
        value={padre.correoPadre}
        onChange={handleChange}
        placeholder="Correo electrónico del padre"
        required
      />
      <button type="button" onClick={agregarHijo}>
        Agregar Hijo
      </button>
      {padre.hijos.map((hijo, index) => (
        <div key={index}>
          <h3>Hijo {index + 1}</h3>
          <input
            type="text"
            name="nombreAlumno"
            value={hijo.nombreAlumno}
            onChange={(e) => handleHijoChange(index, e)}
            placeholder="Nombre del alumno"
            required
          />
          <input
            type="text"
            name="apellidosAlumno"
            value={hijo.apellidosAlumno}
            onChange={(e) => handleHijoChange(index, e)}
            placeholder="Apellidos del alumno"
            required
          />
          {/* Continúa con los otros campos del alumno */}
        </div>
      ))}
      <button type="submit">Registrar</button>
    </form>
  );
};

export default RegistrarPadre;
